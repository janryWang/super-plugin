!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(this,function(){"use strict";var n=function(n){return function(t){return null!=t&&Object.prototype.toString.call(t)==="[object "+n+"]"}},t=n("Function"),r=Array.isArray||n("Array"),e=n("Object"),u=n("String"),o=function(n){return function(){return n}},i=function(n,r){return t(n)?n:o(r)},f=function(n){return u(n)?n:""},c=function(){return Object.create(null)},a=Object.prototype.hasOwnProperty,l=function(n,t){return a.call(n,t)},p=function(n){return void 0!==n&&null!==n},s=function(n,t){return p(n)?n:t},v=function(n,t){for(var r in t)n[r]=t[r];return n},d=function(n,e){if(t(e))if(r(n))for(var u=0,o=n.length;u<o&&e(n[u],u)!==!1;u++);else for(var i in n)if(l(n,i)&&e(n[i],i)===!1)break},y=function(n,e,u){if(t(e)){if(r(n))return n.reduce(e,u);var o=u;return d(n,function(n,t){o=e(o,n,t)}),o}},h=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return function(t){for(var r=[],e=arguments.length-1;e-- >0;)r[e]=arguments[e+1];return y(n,function(n,t){return i(t).apply(void 0,[n].concat(r))},t)}},m=function(n){return f(n).toLowerCase()};module.exports=function(n){function o(t,r,e){return S[t]?function(r){var u=new n(r);return S[t].call(u,r,i(e,r))}:function(t){var u=new n(t);return r.call(u,t,i(e,t))}}function f(n,r){if(e(n))d(n,function(n,t){f(t,n)});else{if(n=m(n),!t(r))return;k[n]||L.push(n),k[n]=o(n,r,k[n])}}function a(n){var t=k[n];return delete t[n],t}function b(n,r){u(n)&&t(r)?l(S,n)||(S[n]=r):d(n,function(n,t){b(t,n)})}function g(n){return n=m(n),k[n]||k["process"+n]}function j(n){return F[n]||(F[n]={name:(r(n)?n:n.split(",")).filter(function(n){return g(n)})},F[n].path=F[n].name.join(",")),F[n]}function O(n,r,e){if(u(n)){var o=j(n),i=o.name,f=o.path;if(i.length&&(k[f]=k[f]||h.apply(null,i.map(function(n){return g(n)})),t(k[f])))return k[f](r)}return s(e,r)}function w(n,t){return p(t)?void(C[n]=t):C[n]}function x(n){return p(n)&&y(L,function(n,t){return O(t,n)},n)}function A(n){r(n)?d(n,function(n){return A(n)}):t(n)?n(P):f(n)}var S=c(),k=c(),C=c(),F=c(),L=[];n=i(n);var P={guard:b,process:f,remove:a,post:O,extension:A,cache:w,all:x};return n.prototype=v(n.prototype,P),P}});